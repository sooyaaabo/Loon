#!name = YouTube (Music)
#!desc = å»é™¤å¹¿å‘Šï¼Œä¼˜åŒ–ç•Œé¢ï¼Œæ”¯æŒå­—å¹•ç¿»è¯‘åŠŸèƒ½ï¼Œæ”¯æŒåå°æ’­æ”¾ã€‚æ”¯æŒPremiumè®¢é˜…ç”¨æˆ·ä½¿ç”¨ï¼Œä¸æ”¯æŒtvOSè®¾å¤‡ã€‚ï¼ˆè‹¥ä½¿ç”¨VirgilClyneåŒè¯­å­—å¹•ç¿»è¯‘æ’ä»¶ï¼Œåˆ™éœ€è¦ç¦ç”¨æœ¬æ’ä»¶çš„å­—å¹•ç¿»è¯‘åŠŸèƒ½ï¼Œä¸”éœ€å°†åŒè¯­å­—å¹•ç¿»è¯‘æ’ä»¶è°ƒæ•´è‡³æœ¬æ’ä»¶ä¸‹æ–¹ï¼‰
#!openUrl = 
#!author = @RuCu6 @Maasea @VirgilClyne @å¯è‰ğŸ…¥
#!homepage = https://github.com/sooyaaabo/Loon
#!icon = https://raw.githubusercontent.com/sooyaaabo/Loon/main/Icon/YouTube.png
#!select = éšè—ä¸Šä¼ æŒ‰é’®, true, false
#!select = éšè—é€‰æ®µæŒ‰é’®, true, false
#!select = å­—å¹•ç¿»è¯‘è¯­è¨€, zh-Hans, zh-Hant, ja, ko, en, off
#!select = æ­Œè¯ç¿»è¯‘è¯­è¨€, zh-Hans, zh-Hant, ja, ko, en, off
#!select = å¯ç”¨è°ƒè¯•æ¨¡å¼, true, false
#select=è‡ªåŠ¨æ˜¾ç¤ºç¿»è¯‘å­—å¹•,æ˜¯,å¦
#select=ä»…è¾“å‡ºå­—å¹•è¯‘æ–‡,æ˜¯,å¦
#select=å­—å¹•è¯‘æ–‡çš„ä½ç½®,è¯‘æ–‡ä½äºåŸæ–‡ä¹‹ä¸Š,è¯‘æ–‡ä½äºåŸæ–‡ä¹‹ä¸‹
#!date = 2024-05-14 18:50

# 2024-05-12 13:45
# https://raw.githubusercontent.com/RuCu6/QuanX/main/Rewrites/Cube/youtube.snippet
# 2024-05-12
# https://github.com/Maasea/sgmodule/blob/master/YouTube.Enhance.sgmodule
# 2024-04-22
# https://github.com/DualSubs/YouTube/blob/main/modules/DualSubs.YouTube.plugin
# 2024-05-14 15:42:41
# https://gitlab.com/lodepuly/vpn_tool/-/raw/master/Tool/Loon/Plugin/YouTube_remove_ads.plugin

[Rule]
AND, ((DOMAIN-SUFFIX, googlevideo.com), (OR, ((PROTOCOL, QUIC), (AND, ((PROTOCOL, UDP), (DEST-PORT, 443)))))), REJECT
AND, ((DOMAIN, youtubei.googleapis.com), (OR, ((PROTOCOL, QUIC), (AND, ((PROTOCOL, UDP), (DEST-PORT, 443)))))), REJECT

[Rewrite]
# æ’­æ”¾é¡µå¹¿å‘Š
^https:\/\/rr[\w-]+\.googlevideo\.com\/initplayback\? reject-dict
^https?:\/\/[\w-]+\.googlevideo\.com\/initplayback.+&oad reject-dict
^https?:\/\/([\w-]+)\.googlevideo\.com\/initplayback(\?.*oad=.+)$ reject-img

[Script]
# YouTubeå»å¹¿å‘Š - æ¥è‡ªMaaseaçš„ä½œå“
http-request ^https:\/\/youtubei\.googleapis\.com\/youtubei\/v1\/(browse|get_watch|next|player|reel\/reel_watch_sequence) script-path = https://raw.githubusercontent.com/Maasea/sgmodule/master/Script/Youtube/dist/youtube.request.preview.js, requires-body = true, binary-body-mode = true, tag = YouTubeè¯·æ±‚
http-response ^https:\/\/youtubei\.googleapis\.com\/youtubei\/v1\/(account\/get_setting|browse|get_watch|guide|next|player|reel\/reel_watch_sequence|search) script-path = https://raw.githubusercontent.com/Maasea/sgmodule/master/Script/Youtube/dist/youtube.response.preview.js, requires-body = true, binary-body-mode = true, tag = YouTubeå“åº”

# YouTubeå­—å¹•ç¿»è¯‘ - æ¥è‡ªVirgilClyneçš„ä½œå“
;http-request ^https?:\/\/(www|m|tv)\.youtube\.com\/youtubei\/v1\/player\?(.*) script-path = https://raw.githubusercontent.com/DualSubs/YouTube/main/js/YouTube.request.js, requires-body = true, tag = JSONÂ·YouTubeæ’­æ”¾å™¨è¯·æ±‚, argument = 
;http-response ^https?:\/\/(www|m|tv)\.youtube\.com\/youtubei\/v1\/player\?(.*) script-path = https://raw.githubusercontent.com/DualSubs/YouTube/main/js/YouTube.response.js, requires-body = true, tag = JSONÂ·YouTubeæ’­æ”¾å™¨å“åº”, argument = 
;http-request ^https?:\/\/youtubei\.googleapis\.com\/youtubei\/v1\/player\?(.*) script-path = https://raw.githubusercontent.com/DualSubs/YouTube/main/js/YouTube.request.js, requires-body = true, binary-body-mode = true, tag = ProtoÂ·YouTubeæ’­æ”¾å™¨è¯·æ±‚, argument = 
;http-response ^https?:\/\/youtubei\.googleapis\.com\/youtubei\/v1\/player\?(.*) script-path = https://raw.githubusercontent.com/DualSubs/YouTube/main/js/YouTube.response.js, requires-body = true, binary-body-mode = true, tag = ProtoÂ·YouTubeæ’­æ”¾å™¨å“åº”, argument = 
;http-request ^https?:\/\/(www|m)\.youtube\.com\/api\/timedtext\?(.*) script-path = https://raw.githubusercontent.com/DualSubs/YouTube/main/js/YouTube.request.js, requires-body = false, tag = YouTubeå®šæ—¶æ–‡æœ¬è¯·æ±‚, argument = 
;http-response ^https?:\/\/(www|m)\.youtube\.com\/api\/timedtext\?(.*)subtype=(Official|External) script-path = https://raw.githubusercontent.com/DualSubs/Universal/main/js/Composite.Subtitles.response.js, requires-body = true, tag = YouTubeåˆæˆå®šæ—¶æ–‡æœ¬å“åº”, argument = 
;http-response ^https?:\/\/(www|m)\.youtube\.com\/api\/timedtext\?(.*)subtype=Translate script-path = https://raw.githubusercontent.com/DualSubs/Universal/main/js/Translate.response.js, requires-body = true, tag = YouTubeç¿»è¯‘å®šæ—¶æ–‡æœ¬å“åº”, argument = 

# YouTube Musicå­—å¹•ç¿»è¯‘ - æ¥è‡ªVirgilClyneçš„ä½œå“
;http-request ^https?:\/\/music\.youtube\.com\/youtubei\/v1\/browse\?(.*) script-path = https://raw.githubusercontent.com/DualSubs/YouTube/main/js/YouTube.request.js, requires-body = true, tag = JSONÂ·YouTube Musicæµè§ˆè¯·æ±‚, argument = 
;http-request ^https?:\/\/youtubei\.googleapis\.com\/youtubei\/v1\/browse\?(.*) script-path = https://raw.githubusercontent.com/DualSubs/YouTube/main/js/YouTube.request.js, requires-body = true, binary-body-mode = true, tag = ProtoÂ·YouTube Musicæµè§ˆè¯·æ±‚, argument = 
;http-response ^https?:\/\/music\.youtube\.com\/youtubei\/v1\/browse\?(.*)subtype=Translate script-path = https://raw.githubusercontent.com/DualSubs/Universal/main/js/Translate.response.js, requires-body = true, tag = JSONÂ·YouTube Musicç¿»è¯‘æ­Œè¯å“åº”, argument = 
;http-response ^https?:\/\/youtubei\.googleapis\.com\/youtubei\/v1\/browse\?(.*)subtype=Translate script-path = https://raw.githubusercontent.com/DualSubs/Universal/main/js/Translate.response.js, requires-body = true, binary-body-mode = true, tag = ProtoÂ·YouTube Musicç¿»è¯‘æ­Œè¯å“åº”, argument = 

[Mitm]
hostname = www.youtube.com, m.youtube.com, tv.youtube.com, music.youtube.com, youtubei.googleapis.com, -redirector*.googlevideo.com, *.googlevideo.com, rr*.googlevideo.com
