#!name = æ±½æ°´éŸ³ä¹
#!desc = è¿‡æ»¤æ±½æ°´éŸ³ä¹å¹¿å‘Š
#!openUrl = https://apps.apple.com/app/id1605585211
#!author = å¯è‰ğŸ…¥[https://github.com/luestr/ProxyResource/blob/main/README.md]
#!tag = å»å¹¿å‘Š
#!system = 
#!system_version = 
#!loon_version = 3.3.7(921)
#!homepage = https://github.com/sooyaaabo/Loon/blob/main/README.md
#!icon = https://raw.githubusercontent.com/sooyaaabo/Loon/main/Icon/App-Icon/SodaMusic.png
#!date = 2025-12-16 20:00

# 2025-08-31 05:46:14
# https://kelee.one/Tool/Loon/Lpx/SodaMusic_remove_ads.lpx

[Rewrite]
^https:\/\/tnc\d-(bjlgy|ali[a-z]{2})\d?\.zijieapi\.com\/get_domains\/v\d\/\? response-body-json-replace data.opaque_data_enabled 0 data.ttnet_http_dns_enabled 0 data.ttnet_quic_enabled 0 data.ttnet_tt_http_dns 0

^https:\/\/tnc\d-(bjlgy|ali[a-z]{2})\d?\.zijieapi\.com\/get_domains\/v\d\/\? response-body-json-jq '.data.ttnet_dispatch_actions |= map(select(.action != "dispatch" and .action != "tc"))'

# è¿½åŠ çš„é”€å”®é…ç½®
^https:\/\/(beta-luna\.douyin|api5-lq\.qishui)\.com\/luna\/commerce\/upsells_config\? reject-dict

# å¹¿å‘Šä¸‹å‘
^https:\/\/(api|api5-lq)\.qishui\.com\/luna\/ads\/ reject-dict
^https:\/\/(beta-luna\.douyin|api5-lq\.qishui)\.com\/luna\/ads\/ reject-dict

# å‘ç°é¡µé¢ - æ­£åœ¨ç›´æ’­Add commentMore actions
^https:\/\/webcast-open\.douyin\.com\/webcast\/openapi\/feed\/\? reject-dict

# ç­¾åˆ°å…¥å£
^https:\/\/(beta-luna\.douyin|api5-lq\.qishui)\.douyin\.com\/luna\/treasure\/entrance\/config\? reject-dict

# æˆ‘çš„é¡µé¢ - çœ‹è§†é¢‘å…è´¹å¬æ­Œ60åˆ†é’Ÿ
^https:\/\/(beta-luna\.douyin|api5-lq\.qishui)\.douyin\.com\/luna\/me\? response-body-json-del reward_ad_banner

# æœç´¢é¡µé¢ - æ¨ªå¹…æ¨å¹¿
^https:\/\/(beta-luna\.douyin|api5-lq\.qishui)\.douyin\.com\/luna\/activities\? reject-dict

# æ’­æ”¾é¡µé¢ - è§†é¢‘æµ
# ^https:\/\/(beta-luna\.douyin|api5-lq\.qishui)\.douyin\.com\/luna\/me\/recently-played-media\? response-body-json-jq '.media |= map(select(.type != "video"))'
^https:\/\/(beta-luna\.douyin|api5-lq\.qishui)\.douyin\.com\/luna\/feed\/song-tab\? response-body-json-jq 'del(.items[] | select(.type == "video_track_mix"))'

# æ’­æ”¾å™¨ç•Œé¢ - æ’­æ”¾è¿›åº¦æ¡æç¤ºè¯­
^https:\/\/(beta-luna\.douyin|api5-lq\.qishui)\.douyin\.com\/luna\/card\? response-body-json-del preview_guide

# æ’­æ”¾å™¨ç•Œé¢ - ä½ å…³æ³¨çš„äººå–œæ¬¢äº†
^https:\/\/(beta-luna\.douyin|api5-lq\.qishui)\.douyin\.com\/luna\/card\? response-body-json-jq 'del(.card_items[] | select(has("priority_display")))'

# æ’­æ”¾å™¨ - è§†é¢‘å¹¿å‘Š
^https:\/\/(beta-luna\.douyin|api5-lq\.qishui)\.douyin\.com\/luna\/media_ads\? reject-dict

# æ­Œæ›²è¯¦æƒ… - çƒ­é—¨è§†é¢‘
^https:\/\/(beta-luna\.douyin|api5-lq\.qishui)\.douyin\.com\/luna\/more-panel\? response-body-json-jq '.blocks |= map(select(.type != "related_video"))'

# å…è´¹å¬æ­Œæ¨å¹¿
^https:\/\/(beta-luna\.douyin|api5-lq\.qishui)\.douyin\.com\/luna\/commerce\/upsells\? reject-dict

# é‚€è¯·å¼€é€šä¼šå‘˜å¼¹çª—
^https:\/\/(beta-luna\.douyin|api5-lq\.qishui)\.douyin\.com\/luna\/commerce\/v2\/commerce_info\? reject-dict

# æŠ–éŸ³çœ‹è¿‡æ‚¬æµ®çª—
^https:\/\/(beta-luna\.douyin|api5-lq\.qishui)\.douyin\.com\/luna\/listen-video\/reminder\? reject-dict

[Script]
# æ’­æ”¾é¡µé¢ - è§†é¢‘æµ[å“åº”ä½“å¤ªå¤§]
http-response ^https:\/\/(beta-luna\.douyin|api5-lq\.qishui)\.douyin\.com\/luna\/me\/recently-played-media\? script-path = https://kelee.one/Resource/JavaScript/SodaMusic/SodaMusic_remove_ads.js, requires-body = true, tag = [æ±½æ°´éŸ³ä¹]ç§»é™¤æ’­æ”¾é¡µé¢è§†é¢‘æµ

[MitM]
hostname = webcast-open.douyin.com, beta-luna.douyin.com, api.qishui.com, api5-lq.qishui.com, tnc*-*.zijieapi.com