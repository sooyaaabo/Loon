// Built at: 2025/12/20 21:49:00
var m=r=>async(t,e)=>{let s=n=>async()=>{let o=n===r.length?e:r[n];if(o)return await o(t,s(n+1))};return s(0)()};function O(r){return typeof r!="object"||r===null?String(r):r instanceof Error?`${r.toString()} ${JSON.stringify({stack:r.stack})}`:Array.isArray(r)?JSON.stringify(r):typeof r.toString=="function"&&r.toString!==Object.prototype.toString?r.toString():JSON.stringify(r)}var p=class extends Error{constructor(e,s=`Process exited with code ${e}`){super(s);this.code=e}name="Exit";toString(){return`[${this.name}] ${this.message}`}};function v(r=0){throw new p(r)}function M(){throw u.abort(),new p(0)}var P=(o=>(o[o.DEBUG=1]="DEBUG",o[o.INFO=2]="INFO",o[o.WARN=3]="WARN",o[o.ERROR=4]="ERROR",o[o.OFF=5]="OFF",o))(P||{}),c=class{static level=4;static setLevel(t){this.level=Number(t)||P[t.toUpperCase()]||4}static log(...t){console.log(t.map(e=>O(e)).join(" "))}static debug(...t){this.level>1||this.log("[DEBUG]",...t)}static info(...t){this.level>2||this.log("[INFO]",...t)}static warn(...t){this.level>3||this.log("[WARN]",...t)}static error(...t){if(this.level>4)return;let e=t[0];if(e instanceof p){e.code!==0&&this.error(e.toString());return}this.log("[ERROR]",...t)}};var y=class r{static getInstance(){return r.instance||(r.instance=r.createInstance()),r.instance}static createInstance(){if(typeof $loon<"u")return new R;if(typeof $task<"u")throw new Error("QuantumultX is not supported");return new g}static instance;request;response;argument={};state={};#t;get url(){return this.#t||(this.#t=new URL(this.request.url)),this.#t}get path(){return this.url.pathname}get method(){return this.request.method}constructor(){this.request=this.createRequest(typeof $request<"u"?$request:null),this.response=this.createResponse(typeof $response<"u"?$response:null)}getJSON(t){let e=this.getVal(t);return e?JSON.parse(e):null}setJSON(t,e){this.setVal(JSON.stringify(t),e)}exit(){$done({})}toString(){let{method:t,url:e}=this.request,{status:s,body:n}=this.response;return JSON.stringify({method:t,url:e,status:s,body:n})}},g=class extends y{createRequest(t){return Object.create(t,{bodyBytes:{get(){return this.body},set(e){this.body=e}}})}createResponse(t){return Object.create(t,{bodyBytes:{get(){return this.body},set(e){this.body=e}}})}initArgument(t){if(Object.assign(this.argument,t),typeof $argument=="string")try{Object.assign(this.argument,JSON.parse($argument))}catch(e){c.log(e)}}getVal(t){return $persistentStore.read(t)}setVal(t,e){return $persistentStore.write(t,e)}fetch(t){let{method:e,body:s,timeout:n=5,...o}=t;return new Promise((i,d)=>{$httpClient[e.toLowerCase()]({...o,body:s,"binary-mode":s instanceof Uint8Array,timeout:n},(a,h,l)=>{if(a)return d(a);i(this.createResponse({...h,body:l}))})})}notify(t="",e="",s="",n={}){let{openUrl:o,clipboard:i,mediaUrl:d,dismiss:a,sound:h=!0}=n,l={url:o,text:i,"media-url":d,"auto-dismiss":a,sound:h};o?l.action="open-url":i&&(l.action="clipboard"),$notification.post(t,e,s,l)}done(t){$done({...t})}abort(){$done({abort:!0})}},R=class extends g{initArgument(t){super.initArgument(t),typeof $argument=="object"&&Object.assign(this.argument,$argument)}fetch(t){return t.timeout=(t.timeout??5)*1e3,t.alpn="h2",super.fetch(t)}notify(t="",e="",s="",n={}){let{openUrl:o,mediaUrl:i,clipboard:d,delay:a}=n,h={openUrl:o,mediaUrl:i,clipboard:d};$notification.post(t,e,s,h,a)}abort(){$done()}};var u=y.getInstance();var b=class{middleware=[];use(t){return this.middleware.push(t),this}run(){m(this.middleware)(u).catch(t=>c.error(t,u)).finally(()=>u.exit())}};var $=async(r,t)=>{await t(),r.done({response:r.response})};var q=async(r,t)=>{if(await t(),!r.state.route)throw new Error("Unexpected request")};var f=class{path;methods;stack;constructor(t,e,s){this.path=t,this.methods=e,this.stack=s}};var U=(r,t)=>t.path===r.path,S=(r,t)=>t.request.url.endsWith(r.path);var x=class{stack=[];matchPath;constructor(t={}){this.matchPath=t.matchPath||U}use(...t){return this.register("",[],t)}get(t,...e){return this.register(t,["GET"],e)}post(t,...e){return this.register(t,["POST"],e)}routes(){return(t,e)=>{let s=this.match(t);if(!s.route)return e();t.state.route=!0;let n=s.pathAndMethod.flatMap(o=>o.stack);return m(n)(t,e)}}match(t){let e={path:[],pathAndMethod:[],route:!1};for(let s of this.stack)(s.path===""||this.matchPath(s,t))&&(e.path.push(s),(s.methods.length===0||s.methods.includes(t.method))&&(e.pathAndMethod.push(s),s.methods.length>0&&(e.route=!0)));return e}register(t,e,s){if(Array.isArray(t))for(let n of t)this.stack.push(new f(n,e,s));else this.stack.push(new f(t,e,s));return this}};var w=new x({matchPath:S});w.post("/getAdList",$,r=>{let t=s=>s==="0007"?'{"materialsList":[{"billMaterialsId":"1","filePath":"#","creativeType":1}],"advertParam":{"skipTime":1}}':s==="G0054"?'{"code":"00","materialsList":[{}]}':'{"code":"00","message":"0"}',e=JSON.parse(r.request.body);r.response.body=t(e.placementNo)});w.post("/mgw.htm",r=>{let t=["com.cars.otsmobile.newHomePageBussData"],e=r.request.headers,s=e["operation-type"]||e["Operation-Type"];t.includes(s)?M():v()});var N=w;var A=new b;A.use(N.routes()).use(q);var H=A;H.run();
